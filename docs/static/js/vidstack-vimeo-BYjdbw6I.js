var le=Object.defineProperty;var B=h=>{throw TypeError(h)};var de=(h,c,e)=>c in h?le(h,c,{enumerable:!0,configurable:!0,writable:!0,value:e}):h[c]=e;var b=(h,c,e)=>de(h,typeof c!="symbol"?c+"":c,e),A=(h,c,e)=>c.has(h)||B("Cannot "+e);var t=(h,c,e)=>(A(h,c,"read from private field"),e?e.call(h):c.get(h)),f=(h,c,e)=>c.has(h)?B("Cannot add the same private member more than once"):c instanceof WeakSet?c.add(h):c.set(h,e),l=(h,c,e,i)=>(A(h,c,"write to private field"),i?i.call(h,e):c.set(h,e),e),a=(h,c,e)=>(A(h,c,"access private method"),e);import{y as fe,J as N,K as C,p as pe,e as S,d as q,b as ye,M as U,L as R,l as be,N as ve,T as ke,Q as _}from"./index-Do0e78z1.js";import{R as me}from"./vidstack-DSYpsFWk-3hTfBkDs.js";import{E as we}from"./vidstack-BSPPDWLF-DL4hHPJ3.js";import{resolveVimeoVideoId as Pe,getVimeoVideoInfo as Te}from"./vidstack-krOAtKMi-C3UUF7YD.js";import"./index-y_Gf3oRl.js";import"./vue-DwQkaS4S.js";import"./element-B2K_PfVG.js";import"./plugin-vueexport-helper-DlAUqK2U.js";const Ce=["bufferend","bufferstart","durationchange","ended","enterpictureinpicture","error","fullscreenchange","leavepictureinpicture","loaded","playProgress","loadProgress","pause","play","playbackratechange","qualitychange","seeked","seeking","timeupdate","volumechange","waiting"];var o,y,v,w,g,I,k,$,M,P,m,V,s,J,K,W,Y,T,z,G,H,Q,X,Z,ee,te,se,L,ie,ne,oe,x,ae,D,re,F,he,ce,u,O,j;class qe extends we{constructor(e,i){super(e);f(this,s);b(this,"$$PROVIDER_TYPE","VIMEO");b(this,"scope",fe());b(this,"fullscreen");f(this,o);f(this,y,N(""));f(this,v,N(!1));f(this,w,null);f(this,g,null);f(this,I,!1);f(this,k,new C(0,0));f(this,$,new me(a(this,s,Y).bind(this)));f(this,M,null);f(this,P,null);f(this,m,new Map);f(this,V,null);b(this,"cookies",!1);b(this,"title",!0);b(this,"byline",!0);b(this,"portrait",!0);b(this,"color","00ADEF");f(this,T,!1);l(this,o,i);const n=this;this.fullscreen={get active(){return t(n,I)},supported:!0,enter:()=>a(this,s,u).call(this,"requestFullscreen"),exit:()=>a(this,s,u).call(this,"exitFullscreen")}}get type(){return"vimeo"}get currentSrc(){return t(this,g)}get videoId(){return t(this,y).call(this)}get hash(){return t(this,w)}get isPro(){return t(this,v).call(this)}preconnect(){pe(this.getOrigin())}setup(){super.setup(),S(a(this,s,J).bind(this)),S(a(this,s,K).bind(this)),S(a(this,s,W).bind(this)),t(this,o).notify("provider-setup",this)}destroy(){a(this,s,O).call(this),this.fullscreen=void 0;const e="provider destroyed";for(const i of t(this,m).values())for(const{reject:n}of i)n(e);t(this,m).clear(),a(this,s,u).call(this,"destroy")}async play(){return a(this,s,u).call(this,"play")}async pause(){return a(this,s,u).call(this,"pause")}setMuted(e){a(this,s,u).call(this,"setMuted",e)}setCurrentTime(e){a(this,s,u).call(this,"seekTo",e),t(this,o).notify("seeking",e)}setVolume(e){a(this,s,u).call(this,"setVolume",e),a(this,s,u).call(this,"setMuted",q(t(this,o).$state.muted))}setPlaybackRate(e){a(this,s,u).call(this,"setPlaybackRate",e)}async loadSource(e){if(!ye(e.src)){l(this,g,null),l(this,w,null),t(this,y).set("");return}const{videoId:i,hash:n}=Pe(e.src);t(this,y).set(i??""),l(this,w,n??null),l(this,g,e)}getOrigin(){return"https://player.vimeo.com"}buildParams(){const{keyDisabled:e}=t(this,o).$props,{playsInline:i,nativeControls:n}=t(this,o).$state,r=n();return{title:this.title,byline:this.byline,color:this.color,portrait:this.portrait,controls:r,h:this.hash,keyboard:r&&!e(),transparent:!0,playsinline:i(),dnt:!this.cookies}}onMessage(e,i){e.event?a(this,s,he).call(this,e.event,e.data,i):e.method&&a(this,s,X).call(this,e.method,e.value,i)}onLoad(){}}o=new WeakMap,y=new WeakMap,v=new WeakMap,w=new WeakMap,g=new WeakMap,I=new WeakMap,k=new WeakMap,$=new WeakMap,M=new WeakMap,P=new WeakMap,m=new WeakMap,V=new WeakMap,s=new WeakSet,J=function(){a(this,s,O).call(this);const e=t(this,y).call(this);if(!e){this.src.set("");return}this.src.set(`${this.getOrigin()}/video/${e}`),t(this,o).notify("load-start")},K=function(){const e=t(this,y).call(this);if(!e)return;const i=U(),n=new AbortController;return l(this,V,i),Te(e,n,t(this,w)).then(r=>{i.resolve(r)}).catch(r=>{i.reject()}),()=>{i.reject(),n.abort()}},W=function(){const e=t(this,v).call(this),{$state:i,qualities:n}=t(this,o);if(i.canSetPlaybackRate.set(e),n[R.setReadonly](!e),e)return be(n,"change",()=>{var d;if(n.auto)return;const r=(d=n.selected)==null?void 0:d.id;r&&a(this,s,u).call(this,"setQuality",r)})},Y=function(){a(this,s,u).call(this,"getCurrentTime")},T=new WeakMap,z=function(e,i){if(t(this,T)&&e===0)return;const{realCurrentTime:n,realDuration:r,paused:d,bufferedEnd:p}=t(this,o).$state;if(n()===e)return;const E=n();t(this,o).notify("time-change",e,i),Math.abs(E-e)>1.5&&(t(this,o).notify("seeking",e,i),!d()&&p()<e&&t(this,o).notify("waiting",void 0,i)),r()-e<.01&&(t(this,o).notify("end",void 0,i),l(this,T,!0),setTimeout(()=>{l(this,T,!1)},500))},G=function(e,i){t(this,o).notify("seeked",e,i)},H=function(e){var n;const i=t(this,y).call(this);(n=t(this,V))==null||n.promise.then(r=>{if(!r)return;const{title:d,poster:p,duration:E,pro:ue}=r;t(this,v).set(ue),t(this,o).notify("title-change",d,e),t(this,o).notify("poster-change",p,e),t(this,o).notify("duration-change",E,e),a(this,s,Q).call(this,E,e)}).catch(()=>{i===t(this,y).call(this)&&(a(this,s,u).call(this,"getVideoTitle"),a(this,s,u).call(this,"getDuration"))})},Q=function(e,i){const{nativeControls:n}=t(this,o).$state,r=n();l(this,k,new C(0,e));const d={buffered:new C(0,0),seekable:t(this,k),duration:e};t(this,o).delegate.ready(d,i),r||a(this,s,u).call(this,"_hideOverlay"),a(this,s,u).call(this,"getQualities"),a(this,s,u).call(this,"getChapters")},X=function(e,i,n){var r;switch(e){case"getVideoTitle":const d=i;t(this,o).notify("title-change",d,n);break;case"getDuration":const p=i;t(this,o).$state.canPlay()?t(this,o).notify("duration-change",p,n):a(this,s,Q).call(this,p,n);break;case"getCurrentTime":a(this,s,z).call(this,i,n);break;case"getBuffered":ve(i)&&i.length&&a(this,s,L).call(this,i[i.length-1][1],n);break;case"setMuted":a(this,s,x).call(this,q(t(this,o).$state.volume),i,n);break;case"getChapters":a(this,s,ae).call(this,i);break;case"getQualities":a(this,s,re).call(this,i,n);break}(r=a(this,s,j).call(this,e))==null||r.resolve()},Z=function(){for(const e of Ce)a(this,s,u).call(this,"addEventListener",e)},ee=function(e){t(this,$).stop(),t(this,o).notify("pause",void 0,e)},te=function(e){t(this,$).start(),t(this,o).notify("play",void 0,e)},se=function(e){const{paused:i}=t(this,o).$state;!i()&&!t(this,T)&&t(this,o).notify("playing",void 0,e)},L=function(e,i){const n={buffered:new C(0,e),seekable:t(this,k)};t(this,o).notify("progress",n,i)},ie=function(e){t(this,o).notify("waiting",void 0,e)},ne=function(e){const{paused:i}=t(this,o).$state;i()||t(this,o).notify("playing",void 0,e)},oe=function(e){const{paused:i}=t(this,o).$state;i()&&t(this,o).notify("play",void 0,e),t(this,o).notify("waiting",void 0,e)},x=function(e,i,n){const r={volume:e,muted:i};t(this,o).notify("volume-change",r,n)},ae=function(e){if(a(this,s,D).call(this),!e.length)return;const i=new ke({kind:"chapters",default:!0}),{realDuration:n}=t(this,o).$state;for(let r=0;r<e.length;r++){const d=e[r],p=e[r+1];i.addCue(new window.VTTCue(d.startTime,(p==null?void 0:p.startTime)??n(),d.title))}l(this,P,i),t(this,o).textTracks.add(i)},D=function(){t(this,P)&&(t(this,o).textTracks.remove(t(this,P)),l(this,P,null))},re=function(e,i){t(this,o).qualities[_.enableAuto]=e.some(n=>n.id==="auto")?()=>a(this,s,u).call(this,"setQuality","auto"):void 0;for(const n of e){if(n.id==="auto")continue;const r=+n.id.slice(0,-1);isNaN(r)||t(this,o).qualities[R.add]({id:n.id,width:r*(16/9),height:r,codec:"avc1,h.264",bitrate:-1},i)}a(this,s,F).call(this,e.find(n=>n.active),i)},F=function({id:e}={},i){if(!e)return;const n=e==="auto",r=t(this,o).qualities.getById(e);n?(t(this,o).qualities[_.setAuto](n,i),t(this,o).qualities[R.select](void 0,!0,i)):t(this,o).qualities[R.select](r??void 0,!0,i)},he=function(e,i,n){switch(e){case"ready":a(this,s,Z).call(this);break;case"loaded":a(this,s,H).call(this,n);break;case"play":a(this,s,te).call(this,n);break;case"playProgress":a(this,s,se).call(this,n);break;case"pause":a(this,s,ee).call(this,n);break;case"loadProgress":a(this,s,L).call(this,i.seconds,n);break;case"waiting":a(this,s,oe).call(this,n);break;case"bufferstart":a(this,s,ie).call(this,n);break;case"bufferend":a(this,s,ne).call(this,n);break;case"volumechange":a(this,s,x).call(this,i.volume,q(t(this,o).$state.muted),n);break;case"durationchange":l(this,k,new C(0,i.duration)),t(this,o).notify("duration-change",i.duration,n);break;case"playbackratechange":t(this,o).notify("rate-change",i.playbackRate,n);break;case"qualitychange":a(this,s,F).call(this,i,n);break;case"fullscreenchange":l(this,I,i.fullscreen),t(this,o).notify("fullscreen-change",i.fullscreen,n);break;case"enterpictureinpicture":t(this,o).notify("picture-in-picture-change",!0,n);break;case"leavepictureinpicture":t(this,o).notify("picture-in-picture-change",!1,n);break;case"ended":t(this,o).notify("end",void 0,n);break;case"error":a(this,s,ce).call(this,i,n);break;case"seek":case"seeked":a(this,s,G).call(this,i.seconds,n);break}},ce=function(e,i){var d;const{message:n,method:r}=e;r==="setPlaybackRate"&&t(this,v).set(!1),r&&((d=a(this,s,j).call(this,r))==null||d.reject(n))},u=async function(e,i){let n=U(),r=t(this,m).get(e);return r||t(this,m).set(e,r=[]),r.push(n),this.postMessage({method:e,value:i}),n.promise},O=function(){t(this,$).stop(),l(this,k,new C(0,0)),l(this,V,null),l(this,M,null),t(this,v).set(!1),a(this,s,D).call(this)},j=function(e){var i;return(i=t(this,m).get(e))==null?void 0:i.shift()};export{qe as VimeoProvider};
