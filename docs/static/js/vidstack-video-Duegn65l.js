var $=Object.defineProperty;var b=i=>{throw TypeError(i)};var N=(i,t,e)=>t in i?$(i,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):i[t]=e;var x=(i,t,e)=>N(i,typeof t!="symbol"?t+"":t,e),E=(i,t,e)=>t.has(i)||b("Cannot "+e);var s=(i,t,e)=>(E(i,t,"read from private field"),e?e.call(i):t.get(i)),n=(i,t,e)=>t.has(i)?b("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(i):t.set(i,e),c=(i,t,e,r)=>(E(i,t,"write to private field"),r?r.call(i,e):t.set(i,e),e),l=(i,t,e)=>(E(i,t,"access private method"),e);import{s as U,u as V,v as A,w as q,x as C,T as F,f as v,E as Y,l as _,D as j}from"./index-DAbrqHd4.js";import{H as z,a as B}from"./vidstack-CQ0j0noX-DTULjCie.js";import"./index-B-rGh_Jz.js";import"./vue-C8k_Ga3h.js";import"./element-CRNjEk8X.js";import"./plugin-vueexport-helper-DlAUqK2U.js";import"./vidstack-DSYpsFWk-DQg0UOXn.js";var P,f,m,D,H;class G{constructor(t,e){n(this,m);n(this,P);n(this,f);c(this,P,t),c(this,f,e),t.textTracks.onaddtrack=l(this,m,D).bind(this),C(l(this,m,H).bind(this))}}P=new WeakMap,f=new WeakMap,m=new WeakSet,D=function(t){const e=t.track;if(!e||J(s(this,P),e))return;const r=new F({id:e.id,kind:e.kind,label:e.label??"",language:e.language,type:"vtt"});r[v.native]={track:e},r[v.readyState]=2,r[v.nativeHLS]=!0;let a=0;const I=O=>{if(e.cues)for(let w=a;w<e.cues.length;w++)r.addCue(e.cues[w],O),a++};I(t),e.oncuechange=I,s(this,f).textTracks.add(r,t),r.setMode(e.mode,t)},H=function(){var t;s(this,P).textTracks.onaddtrack=null;for(const e of s(this,f).textTracks){const r=(t=e[v.native])==null?void 0:t.track;r!=null&&r.oncuechange&&(r.oncuechange=null)}};function J(i,t){return Array.from(i.children).find(e=>e.track===t)}var d,y,k,S,L,T;class K{constructor(t,e){n(this,k);n(this,d);n(this,y);n(this,T,(t,e)=>{s(this,y).notify("picture-in-picture-change",t,e)});c(this,d,t),c(this,y,e),new Y(t).add("enterpictureinpicture",l(this,k,S).bind(this)).add("leavepictureinpicture",l(this,k,L).bind(this))}get active(){return document.pictureInPictureElement===s(this,d)}get supported(){return A(s(this,d))}async enter(){return s(this,d).requestPictureInPicture()}exit(){return document.exitPictureInPicture()}}d=new WeakMap,y=new WeakMap,k=new WeakSet,S=function(t){s(this,T).call(this,!0,t)},L=function(t){s(this,T).call(this,!1,t)},T=new WeakMap;var p,g,o,M,R;class Q{constructor(t,e){n(this,M);n(this,p);n(this,g);n(this,o,"inline");c(this,p,t),c(this,g,e),_(t,"webkitpresentationmodechanged",l(this,M,R).bind(this))}get mode(){return s(this,o)}get supported(){return V(s(this,p))}async setPresentationMode(t){s(this,o)!==t&&s(this,p).webkitSetPresentationMode(t)}}p=new WeakMap,g=new WeakMap,o=new WeakMap,M=new WeakSet,R=function(t){var r;const e=s(this,o);c(this,o,s(this,p).webkitPresentationMode),(r=s(this,g).player)==null||r.dispatch(new j("video-presentation-change",{detail:s(this,o),trigger:t})),["fullscreen","picture-in-picture"].forEach(a=>{(s(this,o)===a||e===a)&&s(this,g).notify(`${a}-change`,s(this,o)===a,t)})};var u;class W{constructor(t){n(this,u);c(this,u,t)}get active(){return s(this,u).mode==="fullscreen"}get supported(){return s(this,u).supported}async enter(){s(this,u).setPresentationMode("fullscreen")}async exit(){s(this,u).setPresentationMode("inline")}}u=new WeakMap;var h;class X{constructor(t){n(this,h);c(this,h,t)}get active(){return s(this,h).mode==="picture-in-picture"}get supported(){return s(this,h).supported}async enter(){s(this,h).setPresentationMode("picture-in-picture")}async exit(){s(this,h).setPresentationMode("inline")}}h=new WeakMap;class ct extends z{constructor(e,r){super(e,r);x(this,"$$PROVIDER_TYPE","VIDEO");x(this,"airPlay");x(this,"fullscreen");x(this,"pictureInPicture");U(()=>{if(this.airPlay=new B(e,r),V(e)){const a=new Q(e,r);this.fullscreen=new W(a),this.pictureInPicture=new X(a)}else A(e)&&(this.pictureInPicture=new K(e,r))},this.scope)}get type(){return"video"}setup(){super.setup(),q(this.video)&&new G(this.video,this.ctx),this.ctx.textRenderers.attachVideo(this.video),C(()=>{this.ctx.textRenderers.attachVideo(null)}),this.type==="video"&&this.ctx.notify("provider-setup",this)}get video(){return this.media}}export{ct as VideoProvider};
